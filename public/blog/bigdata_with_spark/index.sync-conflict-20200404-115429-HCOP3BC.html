<!DOCTYPE html>
<html lang="en-us"><head>
  <meta charset="utf-8">
  <title>BigData with Spark</title>

  <!-- mobile responsive meta -->
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="This is meta description">
  <meta name="author" content="Themefisher">
  <meta name="generator" content="Hugo 0.68.0" />

  <!-- plugins -->
  
  <link rel="stylesheet" href="../../plugins/bootstrap/bootstrap.min.css">
  
  <link rel="stylesheet" href="../../plugins/Ionicons/css/ionicons.min.css">
  
  <link rel="stylesheet" href="../../plugins/magnific-popup/magnific-popup.css">
  
  <link rel="stylesheet" href="../../plugins/slick/slick.css">
  
  <link rel="stylesheet" href="../../plugins/smartslider3/css/normalize.min.css">
  
  <link rel="stylesheet" href="../../plugins/smartslider3/css/smartslider.min.css">
  

  <!-- Main Stylesheet -->
  
  <link rel="stylesheet" href="../../scss/style.min.css" media="screen">

  <!--Favicon-->
  <link rel="shortcut icon" href="../../images/favicon.png" type="image/x-icon">
  <link rel="icon" href="../../images/favicon.png" type="image/x-icon">









  <link rel="stylesheet" type="text/css" href="plugins/smartslider3/css/normalize.min.css" media="screen, print" />
  <link rel="stylesheet" type="text/css" href="plugins/smartslider3/css/smartslider.min.css" media="screen, print" />
  <style type="text/css">.n2-ss-spinner-simple-white-container {
        position: absolute;
        top: 50%;
        left: 50%;
        margin: -20px;
        background: #fff;
        width: 20px;
        height: 20px;
        padding: 10px;
        border-radius: 50%;
        z-index: 1000;
    }
    
    .n2-ss-spinner-simple-white {
      outline: 1px solid RGBA(0,0,0,0);
      width:100%;
      height: 100%;
    }
    
    .n2-ss-spinner-simple-white:before {
        position: absolute;
        top: 50%;
        left: 50%;
        width: 20px;
        height: 20px;
        margin-top: -11px;
        margin-left: -11px;
    }
    
    .n2-ss-spinner-simple-white:not(:required):before {
        content: '';
        border-radius: 50%;
        border-top: 2px solid #333;
        border-right: 2px solid transparent;
        animation: n2SimpleWhite .6s linear infinite;
    }
    @keyframes n2SimpleWhite {
        to {transform: rotate(360deg);}
    }
    .n2-ss-spinner-simple-white-container {
        position: absolute;
        top: 50%;
        left: 50%;
        margin: -20px;
        background: #fff;
        width: 20px;
        height: 20px;
        padding: 10px;
        border-radius: 50%;
        z-index: 1000;
    }
    
    .n2-ss-spinner-simple-white {
      outline: 1px solid RGBA(0,0,0,0);
      width:100%;
      height: 100%;
    }
    
    .n2-ss-spinner-simple-white:before {
        position: absolute;
        top: 50%;
        left: 50%;
        width: 20px;
        height: 20px;
        margin-top: -11px;
        margin-left: -11px;
    }
    
    .n2-ss-spinner-simple-white:not(:required):before {
        content: '';
        border-radius: 50%;
        border-top: 2px solid #333;
        border-right: 2px solid transparent;
        animation: n2SimpleWhite .6s linear infinite;
    }
    @keyframes n2SimpleWhite {
        to {transform: rotate(360deg);}
    }
    .n2-ss-spinner-simple-white-container {
        position: absolute;
        top: 50%;
        left: 50%;
        margin: -20px;
        background: #fff;
        width: 20px;
        height: 20px;
        padding: 10px;
        border-radius: 50%;
        z-index: 1000;
    }
    
    .n2-ss-spinner-simple-white {
      outline: 1px solid RGBA(0,0,0,0);
      width:100%;
      height: 100%;
    }
    
    .n2-ss-spinner-simple-white:before {
        position: absolute;
        top: 50%;
        left: 50%;
        width: 20px;
        height: 20px;
        margin-top: -11px;
        margin-left: -11px;
    }
    
    .n2-ss-spinner-simple-white:not(:required):before {
        content: '';
        border-radius: 50%;
        border-top: 2px solid #333;
        border-right: 2px solid transparent;
        animation: n2SimpleWhite .6s linear infinite;
    }
    @keyframes n2SimpleWhite {
        to {transform: rotate(360deg);}
    }
    .n2-ss-spinner-simple-white-container {
        position: absolute;
        top: 50%;
        left: 50%;
        margin: -20px;
        background: #fff;
        width: 20px;
        height: 20px;
        padding: 10px;
        border-radius: 50%;
        z-index: 1000;
    }
    
    .n2-ss-spinner-simple-white {
      outline: 1px solid RGBA(0,0,0,0);
      width:100%;
      height: 100%;
    }
    
    .n2-ss-spinner-simple-white:before {
        position: absolute;
        top: 50%;
        left: 50%;
        width: 20px;
        height: 20px;
        margin-top: -11px;
        margin-left: -11px;
    }
    
    .n2-ss-spinner-simple-white:not(:required):before {
        content: '';
        border-radius: 50%;
        border-top: 2px solid #333;
        border-right: 2px solid transparent;
        animation: n2SimpleWhite .6s linear infinite;
    }
    @keyframes n2SimpleWhite {
        to {transform: rotate(360deg);}
    }
    .n2-ss-spinner-simple-white-container {
        position: absolute;
        top: 50%;
        left: 50%;
        margin: -20px;
        background: #fff;
        width: 20px;
        height: 20px;
        padding: 10px;
        border-radius: 50%;
        z-index: 1000;
    }
    
    .n2-ss-spinner-simple-white {
      outline: 1px solid RGBA(0,0,0,0);
      width:100%;
      height: 100%;
    }
    
    .n2-ss-spinner-simple-white:before {
        position: absolute;
        top: 50%;
        left: 50%;
        width: 20px;
        height: 20px;
        margin-top: -11px;
        margin-left: -11px;
    }
    
    .n2-ss-spinner-simple-white:not(:required):before {
        content: '';
        border-radius: 50%;
        border-top: 2px solid #333;
        border-right: 2px solid transparent;
        animation: n2SimpleWhite .6s linear infinite;
    }
    @keyframes n2SimpleWhite {
        to {transform: rotate(360deg);}
    }</style>
    <script type="text/javascript">window.N2GSAP=1;window.N2PLATFORM="joomla";(function(){var N=this;N.N2_=N.N2_||{r:[],d:[]},N.N2R=N.N2R||function(){N.N2_.r.push(arguments)},N.N2D=N.N2D||function(){N.N2_.d.push(arguments)}}).call(window);if(!window.n2jQuery){window.n2jQuery={ready:function(cb){console.error('n2jQuery will be deprecated!');N2R(['$'],cb);}}}window.nextend={localization: {}, ready: function(cb){console.error('nextend.ready will be deprecated!');N2R('documentReady', function($){cb.call(window,$)})}};window.N2SSPRO=1;
            nextend.fontsLoaded = false;
            nextend.fontsLoadedActive = function () {nextend.fontsLoaded = true;};
            var requiredFonts = ["Roboto:n3","Roboto:n4"],
                fontData = {
                    google: {
                        families: ["Roboto:300,400:latin"]
                    },
                    active: function(){nextend.fontsLoadedActive()},
                    inactive: function(){nextend.fontsLoadedActive()},
                    fontactive: function(f,s){fontData.resolveFont(f+':'+s);},
                    fontinactive: function(f,s){fontData.resolveFont(f+':'+s);},
                    resolveFont: function(n){
                        for(var i = requiredFonts.length - 1; i >= 0; i--) {
                            if(requiredFonts[i] === n) {
                               requiredFonts.splice(i, 1);
                               break;
                            }
                        }
                        if(!requiredFonts.length) nextend.fontsLoadedActive();
                    }
                };
            if(typeof WebFontConfig !== 'undefined' && typeof WebFont === 'undefined'){
                var _WebFontConfig = WebFontConfig;
                for(var k in WebFontConfig){
                    if(k == 'active'){
                      fontData.active = function(){nextend.fontsLoadedActive();_WebFontConfig.active();}
                    }else if(k == 'inactive'){
                      fontData.inactive = function(){nextend.fontsLoadedActive();_WebFontConfig.inactive();}
                    }else if(k == 'fontactive'){
                      fontData.fontactive = function(f,s){fontData.resolveFont(f+':'+s);_WebFontConfig.fontactive.apply(this,arguments);}
                    }else if(k == 'fontinactive'){
                      fontData.fontinactive = function(f,s){fontData.resolveFont(f+':'+s);_WebFontConfig.fontinactive.apply(this,arguments);}
                    }else if(k == 'google'){
                        if(typeof WebFontConfig.google.families !== 'undefined'){
                            for(var i = 0; i < WebFontConfig.google.families.length; i++){
                                fontData.google.families.push(WebFontConfig.google.families[i]);
                            }
                        }
                    }else{
                        fontData[k] = WebFontConfig[k];
                    }
                }
            }
            fontData.classes=true;
            fontData.events=true;
            
            if(typeof WebFont === 'undefined'){
                window.WebFontConfig = fontData;
            }else{
                WebFont.load(fontData);
            }</script>
    <script type="text/javascript" src="plugins/smartslider3/js/n2-j.min.js"></script>
    <script type="text/javascript" src="plugins/smartslider3/js/nextend-gsap.min.js"></script>
    <script type="text/javascript" src="plugins/smartslider3/js/smartslider-frontend.min.js"></script>
    <script type="text/javascript" src="plugins/smartslider3/js/smartslider-block-type-frontend.min.js"></script>
    <script type="text/javascript" src="plugins/smartslider3/js/GsapMorphSVGPlugin.min.js"></script>
    <script type="text/javascript" src="plugins/smartslider3/js/smartslider-simple-type-frontend.min.js"></script>
    <script type="text/javascript" src="plugins/smartslider3/js/nextend-webfontloader.min.js"></script>
    <script type="text/javascript">N2R('documentReady', function($){
    
            nextend.fontsDeferred = $.Deferred();
            if(nextend.fontsLoaded){
                nextend.fontsDeferred.resolve();
            }else{
                nextend.fontsLoadedActive = function () {
                    nextend.fontsLoaded = true;
                    nextend.fontsDeferred.resolve();
                };
                var intercalCounter = 0;
                nextend.fontInterval = setInterval(function(){
                    if(intercalCounter > 3 || document.documentElement.className.indexOf('wf-active') !== -1){
                        nextend.fontsLoadedActive();
                        clearInterval(nextend.fontInterval);
                    }
                    intercalCounter++;
                }, 1000);
            }
    window.n2ScrollSpeed=400;
    N2R(["smartslider-frontend","nextend-gsap","smartslider-block-type-frontend"],function(){new N2Classes.SmartSliderBlock('#n2-ss-10', {"admin":false,"callbacks":"","background.video.mobile":1,"alias":{"id":0,"smoothScroll":0,"slideSwitch":0,"scrollSpeed":400},"align":"normal","isDelayed":0,"load":{"fade":1,"scroll":0},"playWhenVisible":1,"playWhenVisibleAt":0.5,"responsive":{"hideOn":{"desktop":false,"tablet":false,"mobile":false},"onResizeEnabled":true,"type":"fullwidth","downscale":1,"upscale":1,"minimumHeight":0,"maximumSlideWidth":{"desktopLandscape":1200,"desktopPortrait":1200,"tabletLandscape":1200,"tabletPortrait":1200,"mobileLandscape":1200,"mobilePortrait":1200},"forceFull":1,"forceFullOverflowX":"body","forceFullHorizontalSelector":"","constrainRatio":1,"sliderHeightBasedOn":"real","decreaseSliderHeight":0,"focusUser":1,"focusEdge":"auto","breakpoints":[{"device":"tabletPortrait","type":"max-screen-width","portraitWidth":1199,"landscapeWidth":1199},{"device":"mobilePortrait","type":"max-screen-width","portraitWidth":700,"landscapeWidth":900}],"enabledDevices":{"desktopLandscape":0,"desktopPortrait":1,"tabletLandscape":0,"tabletPortrait":1,"mobileLandscape":0,"mobilePortrait":1},"sizes":{"desktopPortrait":{"width":1200,"height":700,"max":3000,"min":1200},"tabletPortrait":{"width":701,"height":408,"max":1199,"min":701},"mobilePortrait":{"width":320,"height":186,"max":900,"min":320}},"normalizedDeviceModes":{"unknown":"desktopPortrait","desktopPortrait":"desktopPortrait","desktopLandscape":"desktopPortrait","tabletLandscape":"desktopPortrait","tabletPortrait":"tabletPortrait","mobileLandscape":"tabletPortrait","mobilePortrait":"mobilePortrait"},"overflowHiddenPage":0,"focus":{"offsetTop":"","offsetBottom":""}},"controls":{"mousewheel":0,"touch":0,"keyboard":0,"blockCarouselInteraction":1},"lazyLoad":0,"lazyLoadNeighbor":0,"blockrightclick":0,"maintainSession":0,"autoplay":{"enabled":0,"start":0,"duration":8000,"autoplayLoop":0,"allowReStart":0,"pause":{"click":1,"mouse":"enter","mediaStarted":1},"resume":{"click":0,"mouse":0,"mediaEnded":1,"slidechanged":0},"interval":1,"intervalModifier":"loop","intervalSlide":"current"},"perspective":1000,"layerMode":{"playOnce":0,"playFirstLayer":1,"mode":"skippable","inAnimation":"mainInEnd"},"parallax":{"enabled":1,"mobile":0,"is3D":0,"animate":1,"horizontal":"mouse","vertical":"mouse","origin":"slider","scrollmove":"both"},"postBackgroundAnimations":0,"initCallbacks":function($){this.stages.done("ResponsiveStart",function(){var e=this.sliderElement.find(".n2-ss-shape-divider");e.length&&e.each(function(e,t){var a=$(t),o={outer:a,inner:a.find(".n2-ss-shape-divider-inner")};this.sliderElement.on("SliderDeviceOrientation",function(e,t){for(var i=t.device.toLowerCase(),n=0;n<o.outer.length;n++){var s=o.outer.eq(n),a=o.inner.eq(n),r=s.data(i+"height"),d=a.data(i+"width");r<=0?s.css("display","none"):s.css("display",""),""===r&&(r=s.data("desktopportraitheight")),s.css("height",r+"px"),""===d&&(d=a.data("desktopportraitwidth")),a.css({width:d+"%",marginLeft:(d-100)/-2+"%"})}}),a.hasClass("n2-ss-divider-animate")&&this.visible(function(){var e=a.find(".n2-ss-divider-start > *"),t=a.find(".n2-ss-divider-end > *"),i=100/(a.data("speed")||100),n={};e.parent().attr("yoyo")&&(n={onComplete:function(){this.reverse()},onReverseComplete:function(){this.restart()}});for(var s=0;s<e.length;s++)NextendTween.to(e[s],parseFloat(e.eq(s).attr("duration"))*i,$.extend({morphSVG:t[s],delay:0,ease:"easeOutCubic"},n,{delay:e.eq(s).attr("delay"),ease:e.eq(s).attr("ease")}))});var i=a.data("scroll");if("shrink"===i||"grow"===i){var r,n,s=a.data("side"),d=function(e,t){var i=function(){var e,t=0;t=window.matchMedia&&/Android|iPhone|iPad|iPod|BlackBerry/i.test(navigator.userAgent||navigator.vendor||window.opera)?(e=n2const.isIOS?document.documentElement.clientHeight:window.innerHeight,window.matchMedia("(orientation: landscape)").matches?Math.min(screen.width,e):Math.min(screen.height,e)):window.n2ClientHeight||document.documentElement.clientHeight||document.body.clientHeight;return t}(),n=this.sliderElement.offset().top+e,s=$(window).scrollTop();(n<=s+i&&s<=n||0<r&&r<100)&&(r=Math.max(0,Math.min(100,Math.abs(t-(n-s)/i*100))),o.inner.css("height",r+"%"))}.bind(this);"shrink"===i?(o.inner.css("height","100%"),r=100,n=function(){d("bottom"===s?this.sliderElement.height():0,0)}.bind(this)):"grow"===i&&(o.inner.css("height",0),r=0,n=function(){d("bottom"===s?this.sliderElement.height():0,100)}.bind(this)),$(window).on({scroll:n,resize:n}),this.visible(n)}}.bind(this))}.bind(this));}});});
    N2R(["smartslider-frontend","nextend-gsap","smartslider-block-type-frontend"],function(){new N2Classes.SmartSliderBlock('#n2-ss-11', {"admin":false,"callbacks":"","background.video.mobile":1,"alias":{"id":0,"smoothScroll":0,"slideSwitch":0,"scrollSpeed":400},"align":"normal","isDelayed":0,"load":{"fade":1,"scroll":0},"playWhenVisible":1,"playWhenVisibleAt":0.5,"responsive":{"hideOn":{"desktop":false,"tablet":false,"mobile":false},"onResizeEnabled":true,"type":"fullwidth","downscale":1,"upscale":1,"minimumHeight":0,"maximumSlideWidth":{"desktopLandscape":1200,"desktopPortrait":1200,"tabletLandscape":1200,"tabletPortrait":1200,"mobileLandscape":1200,"mobilePortrait":1200},"forceFull":1,"forceFullOverflowX":"body","forceFullHorizontalSelector":"","constrainRatio":1,"sliderHeightBasedOn":"real","decreaseSliderHeight":0,"focusUser":1,"focusEdge":"auto","breakpoints":[{"device":"tabletPortrait","type":"max-screen-width","portraitWidth":1199,"landscapeWidth":1199},{"device":"mobilePortrait","type":"max-screen-width","portraitWidth":700,"landscapeWidth":900}],"enabledDevices":{"desktopLandscape":0,"desktopPortrait":1,"tabletLandscape":0,"tabletPortrait":1,"mobileLandscape":0,"mobilePortrait":1},"sizes":{"desktopPortrait":{"width":1200,"height":400,"max":3000,"min":1200},"tabletPortrait":{"width":701,"height":233,"max":1199,"min":701},"mobilePortrait":{"width":320,"height":106,"max":900,"min":320}},"normalizedDeviceModes":{"unknown":"desktopPortrait","desktopPortrait":"desktopPortrait","desktopLandscape":"desktopPortrait","tabletLandscape":"desktopPortrait","tabletPortrait":"tabletPortrait","mobileLandscape":"tabletPortrait","mobilePortrait":"mobilePortrait"},"overflowHiddenPage":0,"focus":{"offsetTop":"","offsetBottom":""}},"controls":{"mousewheel":0,"touch":0,"keyboard":0,"blockCarouselInteraction":1},"lazyLoad":0,"lazyLoadNeighbor":0,"blockrightclick":0,"maintainSession":0,"autoplay":{"enabled":0,"start":0,"duration":8000,"autoplayLoop":0,"allowReStart":0,"pause":{"click":1,"mouse":"enter","mediaStarted":1},"resume":{"click":0,"mouse":0,"mediaEnded":1,"slidechanged":0},"interval":1,"intervalModifier":"loop","intervalSlide":"current"},"perspective":1000,"layerMode":{"playOnce":0,"playFirstLayer":1,"mode":"skippable","inAnimation":"mainInEnd"},"parallax":{"enabled":1,"mobile":0,"is3D":0,"animate":1,"horizontal":"mouse","vertical":"mouse","origin":"slider","scrollmove":"both"},"postBackgroundAnimations":0,"initCallbacks":function($){}});});
    N2R(["smartslider-frontend","nextend-gsap","smartslider-block-type-frontend"],function(){new N2Classes.SmartSliderBlock('#n2-ss-12', {"admin":false,"callbacks":"","background.video.mobile":1,"alias":{"id":0,"smoothScroll":0,"slideSwitch":0,"scrollSpeed":400},"align":"normal","isDelayed":0,"load":{"fade":1,"scroll":0},"playWhenVisible":1,"playWhenVisibleAt":0.5,"responsive":{"hideOn":{"desktop":false,"tablet":false,"mobile":false},"onResizeEnabled":true,"type":"fullwidth","downscale":1,"upscale":1,"minimumHeight":0,"maximumSlideWidth":{"desktopLandscape":1200,"desktopPortrait":1200,"tabletLandscape":1200,"tabletPortrait":1200,"mobileLandscape":1200,"mobilePortrait":1200},"forceFull":1,"forceFullOverflowX":"body","forceFullHorizontalSelector":"","constrainRatio":1,"sliderHeightBasedOn":"real","decreaseSliderHeight":0,"focusUser":1,"focusEdge":"auto","breakpoints":[{"device":"tabletPortrait","type":"max-screen-width","portraitWidth":1199,"landscapeWidth":1199},{"device":"mobilePortrait","type":"max-screen-width","portraitWidth":700,"landscapeWidth":900}],"enabledDevices":{"desktopLandscape":0,"desktopPortrait":1,"tabletLandscape":0,"tabletPortrait":1,"mobileLandscape":0,"mobilePortrait":1},"sizes":{"desktopPortrait":{"width":1200,"height":600,"max":3000,"min":1200},"tabletPortrait":{"width":701,"height":350,"max":1199,"min":701},"mobilePortrait":{"width":320,"height":160,"max":900,"min":320}},"normalizedDeviceModes":{"unknown":"desktopPortrait","desktopPortrait":"desktopPortrait","desktopLandscape":"desktopPortrait","tabletLandscape":"desktopPortrait","tabletPortrait":"tabletPortrait","mobileLandscape":"tabletPortrait","mobilePortrait":"mobilePortrait"},"overflowHiddenPage":0,"focus":{"offsetTop":"","offsetBottom":""}},"controls":{"mousewheel":0,"touch":0,"keyboard":0,"blockCarouselInteraction":1},"lazyLoad":0,"lazyLoadNeighbor":0,"blockrightclick":0,"maintainSession":0,"autoplay":{"enabled":0,"start":0,"duration":8000,"autoplayLoop":0,"allowReStart":0,"pause":{"click":1,"mouse":"enter","mediaStarted":1},"resume":{"click":0,"mouse":0,"mediaEnded":1,"slidechanged":0},"interval":1,"intervalModifier":"loop","intervalSlide":"current"},"perspective":1000,"layerMode":{"playOnce":0,"playFirstLayer":1,"mode":"skippable","inAnimation":"mainInEnd"},"parallax":{"enabled":1,"mobile":0,"is3D":0,"animate":1,"horizontal":"mouse","vertical":"mouse","origin":"slider","scrollmove":"both"},"backgroundParallax":{"strength":0.5,"tablet":1,"mobile":1},"postBackgroundAnimations":0,"initCallbacks":function($){this.stages.done("ResponsiveStart",function(){var e=this.sliderElement.find(".n2-ss-shape-divider");e.length&&e.each(function(e,t){var a=$(t),o={outer:a,inner:a.find(".n2-ss-shape-divider-inner")};this.sliderElement.on("SliderDeviceOrientation",function(e,t){for(var i=t.device.toLowerCase(),n=0;n<o.outer.length;n++){var s=o.outer.eq(n),a=o.inner.eq(n),r=s.data(i+"height"),d=a.data(i+"width");r<=0?s.css("display","none"):s.css("display",""),""===r&&(r=s.data("desktopportraitheight")),s.css("height",r+"px"),""===d&&(d=a.data("desktopportraitwidth")),a.css({width:d+"%",marginLeft:(d-100)/-2+"%"})}}),a.hasClass("n2-ss-divider-animate")&&this.visible(function(){var e=a.find(".n2-ss-divider-start > *"),t=a.find(".n2-ss-divider-end > *"),i=100/(a.data("speed")||100),n={};e.parent().attr("yoyo")&&(n={onComplete:function(){this.reverse()},onReverseComplete:function(){this.restart()}});for(var s=0;s<e.length;s++)NextendTween.to(e[s],parseFloat(e.eq(s).attr("duration"))*i,$.extend({morphSVG:t[s],delay:0,ease:"easeOutCubic"},n,{delay:e.eq(s).attr("delay"),ease:e.eq(s).attr("ease")}))});var i=a.data("scroll");if("shrink"===i||"grow"===i){var r,n,s=a.data("side"),d=function(e,t){var i=function(){var e,t=0;t=window.matchMedia&&/Android|iPhone|iPad|iPod|BlackBerry/i.test(navigator.userAgent||navigator.vendor||window.opera)?(e=n2const.isIOS?document.documentElement.clientHeight:window.innerHeight,window.matchMedia("(orientation: landscape)").matches?Math.min(screen.width,e):Math.min(screen.height,e)):window.n2ClientHeight||document.documentElement.clientHeight||document.body.clientHeight;return t}(),n=this.sliderElement.offset().top+e,s=$(window).scrollTop();(n<=s+i&&s<=n||0<r&&r<100)&&(r=Math.max(0,Math.min(100,Math.abs(t-(n-s)/i*100))),o.inner.css("height",r+"%"))}.bind(this);"shrink"===i?(o.inner.css("height","100%"),r=100,n=function(){d("bottom"===s?this.sliderElement.height():0,0)}.bind(this)):"grow"===i&&(o.inner.css("height",0),r=0,n=function(){d("bottom"===s?this.sliderElement.height():0,100)}.bind(this)),$(window).on({scroll:n,resize:n}),this.visible(n)}}.bind(this))}.bind(this));}});});
    N2R(["smartslider-frontend","nextend-gsap","smartslider-block-type-frontend"],function(){new N2Classes.SmartSliderBlock('#n2-ss-13', {"admin":false,"callbacks":"","background.video.mobile":1,"alias":{"id":0,"smoothScroll":0,"slideSwitch":0,"scrollSpeed":400},"align":"normal","isDelayed":0,"load":{"fade":1,"scroll":0},"playWhenVisible":1,"playWhenVisibleAt":0.5,"responsive":{"hideOn":{"desktop":false,"tablet":false,"mobile":false},"onResizeEnabled":true,"type":"fullwidth","downscale":1,"upscale":1,"minimumHeight":0,"maximumSlideWidth":{"desktopLandscape":1200,"desktopPortrait":1200,"tabletLandscape":1200,"tabletPortrait":1200,"mobileLandscape":1200,"mobilePortrait":1200},"forceFull":1,"forceFullOverflowX":"body","forceFullHorizontalSelector":"","constrainRatio":1,"sliderHeightBasedOn":"real","decreaseSliderHeight":0,"focusUser":1,"focusEdge":"auto","breakpoints":[{"device":"tabletPortrait","type":"max-screen-width","portraitWidth":1199,"landscapeWidth":1199},{"device":"mobilePortrait","type":"max-screen-width","portraitWidth":700,"landscapeWidth":900}],"enabledDevices":{"desktopLandscape":0,"desktopPortrait":1,"tabletLandscape":0,"tabletPortrait":1,"mobileLandscape":0,"mobilePortrait":1},"sizes":{"desktopPortrait":{"width":1200,"height":600,"max":3000,"min":1200},"tabletPortrait":{"width":701,"height":350,"max":1199,"min":701},"mobilePortrait":{"width":320,"height":160,"max":900,"min":320}},"normalizedDeviceModes":{"unknown":"desktopPortrait","desktopPortrait":"desktopPortrait","desktopLandscape":"desktopPortrait","tabletLandscape":"desktopPortrait","tabletPortrait":"tabletPortrait","mobileLandscape":"tabletPortrait","mobilePortrait":"mobilePortrait"},"overflowHiddenPage":0,"focus":{"offsetTop":"","offsetBottom":""}},"controls":{"mousewheel":0,"touch":0,"keyboard":0,"blockCarouselInteraction":1},"lazyLoad":0,"lazyLoadNeighbor":0,"blockrightclick":0,"maintainSession":0,"autoplay":{"enabled":0,"start":0,"duration":8000,"autoplayLoop":0,"allowReStart":0,"pause":{"click":1,"mouse":"enter","mediaStarted":1},"resume":{"click":0,"mouse":0,"mediaEnded":1,"slidechanged":0},"interval":1,"intervalModifier":"loop","intervalSlide":"current"},"perspective":1000,"layerMode":{"playOnce":0,"playFirstLayer":1,"mode":"skippable","inAnimation":"mainInEnd"},"parallax":{"enabled":1,"mobile":0,"is3D":0,"animate":1,"horizontal":"mouse","vertical":"mouse","origin":"slider","scrollmove":"both"},"postBackgroundAnimations":0,"initCallbacks":function($){new N2Classes.FrontendItemHeadingSplitText(this, "n2-ss-13item1", "0% 50% 0px", "visible",  {"name":"Static","data":{"mode":"words","sort":"normal","duration":0.5,"stagger":0.05,"ease":"easeInOutQuad","opacity":0,"scale":1,"x":"50","y":"0","rotationX":0,"rotationY":0,"rotationZ":0}},0.4, false, 0);}});});
    N2R(["smartslider-frontend","nextend-gsap","smartslider-simple-type-frontend"],function(){new N2Classes.SmartSliderSimple('#n2-ss-14', {"admin":false,"callbacks":"","background.video.mobile":1,"randomize":{"randomize":0,"randomizeFirst":0},"alias":{"id":0,"smoothScroll":0,"slideSwitch":0,"scrollSpeed":400},"align":"normal","isDelayed":0,"load":{"fade":1,"scroll":0},"playWhenVisible":1,"playWhenVisibleAt":0.5,"responsive":{"hideOn":{"desktop":false,"tablet":false,"mobile":false},"onResizeEnabled":true,"type":"fullwidth","downscale":1,"upscale":1,"minimumHeight":0,"maximumSlideWidth":{"desktopLandscape":1200,"desktopPortrait":1200,"tabletLandscape":1200,"tabletPortrait":1200,"mobileLandscape":1200,"mobilePortrait":1200},"forceFull":1,"forceFullOverflowX":"body","forceFullHorizontalSelector":"","constrainRatio":1,"sliderHeightBasedOn":"real","decreaseSliderHeight":0,"focusUser":1,"focusEdge":"auto","breakpoints":[{"device":"tabletPortrait","type":"max-screen-width","portraitWidth":1199,"landscapeWidth":1199},{"device":"mobilePortrait","type":"max-screen-width","portraitWidth":700,"landscapeWidth":900}],"enabledDevices":{"desktopLandscape":0,"desktopPortrait":1,"tabletLandscape":0,"tabletPortrait":1,"mobileLandscape":0,"mobilePortrait":1},"sizes":{"desktopPortrait":{"width":1200,"height":600,"max":3000,"min":1200},"tabletPortrait":{"width":701,"height":350,"max":1199,"min":701},"mobilePortrait":{"width":320,"height":160,"max":900,"min":320}},"normalizedDeviceModes":{"unknown":"desktopPortrait","desktopPortrait":"desktopPortrait","desktopLandscape":"desktopPortrait","tabletLandscape":"desktopPortrait","tabletPortrait":"tabletPortrait","mobileLandscape":"tabletPortrait","mobilePortrait":"mobilePortrait"},"overflowHiddenPage":0,"focus":{"offsetTop":"","offsetBottom":""}},"controls":{"mousewheel":0,"touch":"horizontal","keyboard":1,"blockCarouselInteraction":1},"lazyLoad":0,"lazyLoadNeighbor":0,"blockrightclick":0,"maintainSession":0,"autoplay":{"enabled":0,"start":1,"duration":8000,"autoplayLoop":1,"allowReStart":0,"pause":{"click":1,"mouse":"0","mediaStarted":1},"resume":{"click":0,"mouse":"0","mediaEnded":1,"slidechanged":0},"interval":1,"intervalModifier":"loop","intervalSlide":"current"},"perspective":1000,"layerMode":{"playOnce":0,"playFirstLayer":1,"mode":"skippable","inAnimation":"mainInEnd"},"parallax":{"enabled":1,"mobile":0,"is3D":0,"animate":1,"horizontal":"mouse","vertical":"mouse","origin":"slider","scrollmove":"both"},"postBackgroundAnimations":0,"bgAnimationsColor":"RGBA(51,51,51,1)","bgAnimations":0,"mainanimation":{"type":"horizontal","duration":800,"delay":0,"ease":"easeOutQuad","parallax":0,"shiftedBackgroundAnimation":"auto"},"carousel":1,"dynamicHeight":0,"initCallbacks":function($){N2D("SmartSliderWidgetArrowImage","SmartSliderWidget",function(i,e){function r(i,e,t,s,r,o){this.key=i,this.action=t,this.desktopRatio=s,this.tabletRatio=r,this.mobileRatio=o,N2Classes.SmartSliderWidget.prototype.constructor.call(this,e)}return((r.prototype=Object.create(N2Classes.SmartSliderWidget.prototype)).constructor=r).prototype.onStart=function(){this.deferred=i.Deferred(),this.slider.sliderElement.on("SliderDevice",this.onDevice.bind(this)).trigger("addWidget",this.deferred),this.$widget=i("#"+this.slider.elementID+"-arrow-"+this.key).on("click",function(i){i.stopPropagation(),this.slider[this.action]()}.bind(this)),this.$resize=this.$widget.find(".n2-resize"),0===this.$resize.length&&(this.$resize=this.$widget),i.when(this.$widget.n2imagesLoaded()).always(this.onLoad.bind(this))},r.prototype.onLoad=function(){this.$widget.addClass("n2-ss-widget--calc"),this.previousWidth=this.$resize.width(),this.previousHeight=this.$resize.height(),this.$widget.removeClass("n2-ss-widget--calc"),this.$resize.find("img").css("width","100%"),this.onDevice(null,{device:this.slider.responsive.getDeviceMode()}),this.deferred.resolve()},r.prototype.onDevice=function(i,e){var t=1;switch(e.device){case"tabletPortrait":case"tabletLandscape":t=this.tabletRatio;break;case"mobilePortrait":case"mobileLandscape":t=this.mobileRatio;break;default:t=this.desktopRatio}this.$resize.width(this.previousWidth*t),this.$resize.height(this.previousHeight*t)},function(i,e,t,s){this.key="arrow",this.previous=new r("previous",i,"previousWithDirection",e,t,s),this.next=new r("next",i,"nextWithDirection",e,t,s)}});new N2Classes.SmartSliderWidgetArrowImage(this, 1, 0.7, 0.5);this.stages.done("ResponsiveStart",function(){var e=this.sliderElement.find(".n2-ss-shape-divider");e.length&&e.each(function(e,t){var a=$(t),o={outer:a,inner:a.find(".n2-ss-shape-divider-inner")};this.sliderElement.on("SliderDeviceOrientation",function(e,t){for(var i=t.device.toLowerCase(),n=0;n<o.outer.length;n++){var s=o.outer.eq(n),a=o.inner.eq(n),r=s.data(i+"height"),d=a.data(i+"width");r<=0?s.css("display","none"):s.css("display",""),""===r&&(r=s.data("desktopportraitheight")),s.css("height",r+"px"),""===d&&(d=a.data("desktopportraitwidth")),a.css({width:d+"%",marginLeft:(d-100)/-2+"%"})}}),a.hasClass("n2-ss-divider-animate")&&this.visible(function(){var e=a.find(".n2-ss-divider-start > *"),t=a.find(".n2-ss-divider-end > *"),i=100/(a.data("speed")||100),n={};e.parent().attr("yoyo")&&(n={onComplete:function(){this.reverse()},onReverseComplete:function(){this.restart()}});for(var s=0;s<e.length;s++)NextendTween.to(e[s],parseFloat(e.eq(s).attr("duration"))*i,$.extend({morphSVG:t[s],delay:0,ease:"easeOutCubic"},n,{delay:e.eq(s).attr("delay"),ease:e.eq(s).attr("ease")}))});var i=a.data("scroll");if("shrink"===i||"grow"===i){var r,n,s=a.data("side"),d=function(e,t){var i=function(){var e,t=0;t=window.matchMedia&&/Android|iPhone|iPad|iPod|BlackBerry/i.test(navigator.userAgent||navigator.vendor||window.opera)?(e=n2const.isIOS?document.documentElement.clientHeight:window.innerHeight,window.matchMedia("(orientation: landscape)").matches?Math.min(screen.width,e):Math.min(screen.height,e)):window.n2ClientHeight||document.documentElement.clientHeight||document.body.clientHeight;return t}(),n=this.sliderElement.offset().top+e,s=$(window).scrollTop();(n<=s+i&&s<=n||0<r&&r<100)&&(r=Math.max(0,Math.min(100,Math.abs(t-(n-s)/i*100))),o.inner.css("height",r+"%"))}.bind(this);"shrink"===i?(o.inner.css("height","100%"),r=100,n=function(){d("bottom"===s?this.sliderElement.height():0,0)}.bind(this)):"grow"===i&&(o.inner.css("height",0),r=0,n=function(){d("bottom"===s?this.sliderElement.height():0,100)}.bind(this)),$(window).on({scroll:n,resize:n}),this.visible(n)}}.bind(this))}.bind(this));}});});
    N2R(["smartslider-frontend","nextend-gsap","smartslider-block-type-frontend"],function(){new N2Classes.SmartSliderBlock('#n2-ss-15', {"admin":false,"callbacks":"","background.video.mobile":1,"alias":{"id":0,"smoothScroll":0,"slideSwitch":0,"scrollSpeed":400},"align":"normal","isDelayed":0,"load":{"fade":1,"scroll":0},"playWhenVisible":1,"playWhenVisibleAt":0.5,"responsive":{"hideOn":{"desktop":false,"tablet":false,"mobile":false},"onResizeEnabled":true,"type":"fullwidth","downscale":1,"upscale":1,"minimumHeight":0,"maximumSlideWidth":{"desktopLandscape":1200,"desktopPortrait":1200,"tabletLandscape":1200,"tabletPortrait":1200,"mobileLandscape":1200,"mobilePortrait":1200},"forceFull":1,"forceFullOverflowX":"body","forceFullHorizontalSelector":"","constrainRatio":1,"sliderHeightBasedOn":"real","decreaseSliderHeight":0,"focusUser":1,"focusEdge":"auto","breakpoints":[{"device":"tabletPortrait","type":"max-screen-width","portraitWidth":1199,"landscapeWidth":1199},{"device":"mobilePortrait","type":"max-screen-width","portraitWidth":700,"landscapeWidth":900}],"enabledDevices":{"desktopLandscape":0,"desktopPortrait":1,"tabletLandscape":0,"tabletPortrait":1,"mobileLandscape":0,"mobilePortrait":1},"sizes":{"desktopPortrait":{"width":1200,"height":500,"max":3000,"min":1200},"tabletPortrait":{"width":701,"height":292,"max":1199,"min":701},"mobilePortrait":{"width":320,"height":133,"max":900,"min":320}},"normalizedDeviceModes":{"unknown":"desktopPortrait","desktopPortrait":"desktopPortrait","desktopLandscape":"desktopPortrait","tabletLandscape":"desktopPortrait","tabletPortrait":"tabletPortrait","mobileLandscape":"tabletPortrait","mobilePortrait":"mobilePortrait"},"overflowHiddenPage":0,"focus":{"offsetTop":"","offsetBottom":""}},"controls":{"mousewheel":0,"touch":0,"keyboard":0,"blockCarouselInteraction":1},"lazyLoad":0,"lazyLoadNeighbor":0,"blockrightclick":0,"maintainSession":0,"autoplay":{"enabled":0,"start":0,"duration":8000,"autoplayLoop":0,"allowReStart":0,"pause":{"click":1,"mouse":"enter","mediaStarted":1},"resume":{"click":0,"mouse":0,"mediaEnded":1,"slidechanged":0},"interval":1,"intervalModifier":"loop","intervalSlide":"current"},"perspective":1000,"layerMode":{"playOnce":0,"playFirstLayer":1,"mode":"skippable","inAnimation":"mainInEnd"},"parallax":{"enabled":1,"mobile":0,"is3D":0,"animate":1,"horizontal":"mouse","vertical":"mouse","origin":"slider","scrollmove":"both"},"postBackgroundAnimations":0,"initCallbacks":function($){}});});
    N2R(["smartslider-frontend","nextend-gsap","smartslider-block-type-frontend"],function(){new N2Classes.SmartSliderBlock('#n2-ss-16', {"admin":false,"callbacks":"","background.video.mobile":1,"alias":{"id":0,"smoothScroll":0,"slideSwitch":0,"scrollSpeed":400},"align":"normal","isDelayed":0,"load":{"fade":1,"scroll":0},"playWhenVisible":1,"playWhenVisibleAt":0.5,"responsive":{"hideOn":{"desktop":false,"tablet":false,"mobile":false},"onResizeEnabled":true,"type":"fullwidth","downscale":1,"upscale":1,"minimumHeight":0,"maximumSlideWidth":{"desktopLandscape":1200,"desktopPortrait":1200,"tabletLandscape":1200,"tabletPortrait":1200,"mobileLandscape":1200,"mobilePortrait":1200},"forceFull":1,"forceFullOverflowX":"body","forceFullHorizontalSelector":"","constrainRatio":1,"sliderHeightBasedOn":"real","decreaseSliderHeight":0,"focusUser":1,"focusEdge":"auto","breakpoints":[{"device":"tabletPortrait","type":"max-screen-width","portraitWidth":1199,"landscapeWidth":1199},{"device":"mobilePortrait","type":"max-screen-width","portraitWidth":700,"landscapeWidth":900}],"enabledDevices":{"desktopLandscape":0,"desktopPortrait":1,"tabletLandscape":0,"tabletPortrait":1,"mobileLandscape":0,"mobilePortrait":1},"sizes":{"desktopPortrait":{"width":1200,"height":300,"max":3000,"min":1200},"tabletPortrait":{"width":701,"height":175,"max":1199,"min":701},"mobilePortrait":{"width":320,"height":80,"max":900,"min":320}},"normalizedDeviceModes":{"unknown":"desktopPortrait","desktopPortrait":"desktopPortrait","desktopLandscape":"desktopPortrait","tabletLandscape":"desktopPortrait","tabletPortrait":"tabletPortrait","mobileLandscape":"tabletPortrait","mobilePortrait":"mobilePortrait"},"overflowHiddenPage":0,"focus":{"offsetTop":"","offsetBottom":""}},"controls":{"mousewheel":0,"touch":0,"keyboard":0,"blockCarouselInteraction":1},"lazyLoad":0,"lazyLoadNeighbor":0,"blockrightclick":0,"maintainSession":0,"autoplay":{"enabled":0,"start":0,"duration":8000,"autoplayLoop":0,"allowReStart":0,"pause":{"click":1,"mouse":"enter","mediaStarted":1},"resume":{"click":0,"mouse":0,"mediaEnded":1,"slidechanged":0},"interval":1,"intervalModifier":"loop","intervalSlide":"current"},"perspective":1000,"layerMode":{"playOnce":0,"playFirstLayer":1,"mode":"skippable","inAnimation":"mainInEnd"},"parallax":{"enabled":1,"mobile":0,"is3D":0,"animate":1,"horizontal":"mouse","vertical":"mouse","origin":"slider","scrollmove":"both"},"postBackgroundAnimations":0,"initCallbacks":function($){}});});
    });
    </script>




</head><body>
<!-- preloader start -->
<div class="preloader">
  
</div>
<!-- preloader end -->

<header class="navigation">
  <div class="container">
    <div class="row">
      <div class="col-md-12">
        
        <nav class="navbar">
          
          <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navigation">
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="../../">
              <img src="../../images/logo2-200x50.png" alt="Airspace | Creative Agency Hugo Template" class="img-responsive">
            </a>
          </div>
          
          <div class="collapse navbar-collapse" id="navigation">
            <ul class="nav navbar-nav navbar-right">
              <li><a href="../../">Home</a></li>

              
              
              <li><a href="../../about">About</a></li>
              
              
              
              <li><a href="../../project">Project</a></li>
              
              
              
              <li><a href="../../service">Service</a></li>
              
              
              
              <li><a href="../../blog">Blog</a></li>
              
              
              
              <li class="dropdown">
                <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true"
                  aria-expanded="false">Pages <span class="ion-ios-arrow-down"></span></a>
                <ul class="dropdown-menu">
                  
                  <li><a href="../../pricing">Pricing</a></li>
                  
                </ul>
              </li>
              
              
              
              <li><a href="../../contact">Contact</a></li>
              
              

              

            </ul>
          </div>
        </nav>
      </div>
    </div>
  </div>
</header>

<section class="page-title bg-2" style="background-image: url('/');">
  <div class="container">
    <div class="row">
      <div class="col-md-12">
        <div class="block">
          <h1>BigData with Spark</h1>
          <p></p>
        </div>
      </div>
    </div>
  </div>
</section>

<section class="page-wrapper">
	<div class="container">
		<div class="row">
			<div class="col-md-8">
				<div class="post post-single">
					<h2 class="post-title">BigData with Spark</h2>
					<div class="post-meta">
						<ul>
              <li><i class="ion-calendar"></i> June 5, 2018</li>
              <li><i class="ion-android-people"></i> Posted By <a class="text-primary" href="../../author/dannyjra">DannyJRa</a></li>
              <li><i class="ion-pricetags"></i> 
                
                <a href="../../tags/bigdata">Big data</a>
								
                , <a href="../../tags/azure">Azure</a>
								
              </li>
            </ul>
					</div>
					<div class="post-thumb">
						<img class="img-responsive" src="../../images/blog/05_BLOG.png" alt="BigData with Spark">
					</div>
					<div class="post-content post-excerpt">
						<p>Original post here: <a href="https://dannyjra.github.io/05_Blog_BigData_Spark/01_blog_caret_Tut.html">https://dannyjra.github.io/05_Blog_BigData_Spark/01_blog_caret_Tut.html</a></p>
<p>Add summary desdcription of blog</p>
<h1 id="use-case">Use Case</h1>
<p>In this case a Ubuntu DSVM is deployed. The
virtual machine is created within its own resource group so that all
created resources (the VM, networking, disk, etc) can be deleted
easily. Code is also included, and run, to then delete the
resource group if the resource group was created within this
vignette. Once deleted consumption (cost) will cease.</p>
<h1 id="setup">Setup</h1>
<p>To get started we need to load our Azure credentials as well as the
user&rsquo;s ssh public key. Public keys on Linux are typically created on
the users desktop/laptop machine and will be found within
~/.ssh/id_rsa.pub. It will be convenient to create a credentials file
to contain this information.</p>
<p>#Authorization</p>
<p>We can simply source the credentials file in R.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#75715e"># Load the required subscription resources: TID, CID, and KEY.</span>
<span style="color:#75715e"># Also includes the ssh PUBKEY for the user.</span>

USER <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">Sys.info</span>()[[<span style="color:#e6db74">&#39;user&#39;</span>]]
<span style="color:#75715e">#or set manually</span>
USER<span style="color:#f92672">&lt;-</span><span style="color:#e6db74">&#34;insider&#34;</span>

<span style="color:#a6e22e">source</span>(<span style="color:#e6db74">&#34;~/02_CloudComputing/10_Secrets/Azure_Authentication_datascience_AWS.R&#34;</span>)
</code></pre></div><p>If the required pacakges are not yet installed the following will do
so. You may need to install them into your own local library rather
than the system library if you are not a system user.</p>
<p>We can then load the required pacakges from the libraries.</p>
<h1 id="set-hdinsight">Set HDInsight</h1>
<h2 id="overview">Overview</h2>
<p><code>AzureSMR</code> provides an interface to manage resources on Microsoft Azure. The main functions address the following Azure Services:</p>
<ul>
<li>Azure Blob: List, Read and Write to Blob Services</li>
<li>Azure Resources: List, Create and Delete Azure Resource</li>
<li>Azure VM: List, Start and Stop Azure VMs</li>
<li>Azure HDI: List and Scale Azure HDInsight Clusters</li>
<li>Azure Hive: Run Hive queries against a HDInsight Cluster</li>
<li>Azure Spark: List and create Spark jobs/Sessions against a HDInsight Cluster(Livy) - EXPERIMENTAL</li>
<li>Azure Data Lake Store: ListStatus, GetFileStatus, MkDirs, Create (file), Append (file), Read (file), Delete</li>
</ul>
<p>For a detailed list of <code>AzureSMR</code> functions and their syntax please refer to the Help pages.</p>
<h2 id="configuring-authorisation-in-azure-active-directory">Configuring authorisation in Azure Active Directory</h2>
<p>To get started, please refer to the <a href="http://htmlpreview.github.io/?https://github.com/Microsoft/AzureSMR/blob/master/inst/doc/Authentication.html">authorisation tutorial</a></p>
<h2 id="load-the-package">Load the package</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#a6e22e">library</span>(AzureSMR)
</code></pre></div><h2 id="authenticating-against-the-azure-service">Authenticating against the Azure service</h2>
<p>The Azure APIs require many parameters to be managed. Rather than supplying all the arguments to every function call, <code>AzureSMR</code> uses an <code>azureActiveContext</code> object that caches arguments so you don&rsquo;t have to supply .</p>
<p>To create an <code>azureActiveContext</code> object and attempt to authenticate against the Azure service, use:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">context <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">createAzureContext</span>(tenantID<span style="color:#f92672">=</span>TID, clientID<span style="color:#f92672">=</span>CID, authKey<span style="color:#f92672">=</span>KEY)
</code></pre></div><p>##Create a resource group</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#a6e22e">azureCreateResourceGroup</span>(context, resourceGroup <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;R_Control&#34;</span>, location <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;centralus&#34;</span>)
</code></pre></div><h2 id="manage-hdinsight-clusters">Manage HDInsight clusters</h2>
<p>You can use <code>AzureSMR</code> to manage <a href="https://azure.microsoft.com/en-gb/services/hdinsight/">HDInsight</a> clusters. To create a cluster use <code>azureCreateHDI()</code>.</p>
<p>For advanced configurations use Resource Templates (See below).
ca. 17 minutes</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#a6e22e">azureCreateHDI</span>(context,
                 resourceGroup <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;R_control&#34;</span>,
                 clustername <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;smrhdi&#34;</span>, <span style="color:#75715e"># only low case letters, digit, and dash.</span>
                 storageAccount <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;testmystorage&#34;</span>,
                 adminUser <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;hdiadmin&#34;</span>,
                 adminPassword <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;AzureSMR_password123&#34;</span>,
                 sshUser <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;hdisshuser&#34;</span>,
                 sshPassword <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;AzureSMR_password123&#34;</span>, 
                 kind <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;rserver&#34;</span>,
               location<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;centralus&#34;</span>)
</code></pre></div><p>Use <code>azureListHDI()</code> to list available clusters.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#a6e22e">azureListHDI</span>(context, resourceGroup <span style="color:#f92672">=</span><span style="color:#e6db74">&#34;R_control&#34;</span>)
</code></pre></div><p>Use <code>azureResizeHDI()</code> to resize a cluster
NOT_WORKING</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#a6e22e">azureResizeHDI</span>(context, resourceGroup <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;R_control&#34;</span>, clustername <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;smrhdi&#34;</span>, role<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;workernode&#34;</span>,size<span style="color:#f92672">=</span><span style="color:#ae81ff">3</span>)

<span style="color:#75715e">## azureResizeHDI: Request Submitted:  2016-06-23 18:50:57</span>
<span style="color:#75715e">## Resizing(R), Succeeded(S)</span>
<span style="color:#75715e">## RRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRRR</span>
<span style="color:#75715e">## RRRRRRRRRRRRRRRRRRS</span>
<span style="color:#75715e">## Finished Resizing Sucessfully:  2016-06-23 19:04:43</span>
<span style="color:#75715e">## Finished:  2016-06-23 19:04:43</span>
<span style="color:#75715e">##                                                                                                                        ## Information </span>
<span style="color:#75715e">## &#34; headnode ( 2 * Standard_D3_v2 ) workernode ( 5 * Standard_D3_v2 ) zookeepernode ( 3 * Medium ) edgenode0 ( 1 * Standard_D4_v2 )&#34; </span>
</code></pre></div><p>ADMIN TIP: If a deployment fails, go to the Azure Portal and look at <code>Activity logs</code> and look for failed deployments - this should explain why the deployment failed.</p>
<h2 id="hive-functions">Hive Functions</h2>
<p>You can use these functions to run and manage hive jobs on an HDInsight Cluster.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#a6e22e">azureHiveStatus</span>(context, clusterName <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;smrhdi&#34;</span>, 
                hdiAdmin <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;hdiadmin&#34;</span>, 
                hdiPassword <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;AzureSMR_password123&#34;</span>)

<span style="color:#a6e22e">azureHiveSQL</span>(context, 
             CMD <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;select * from hivesampletable&#34;</span>, 
             path <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;wasb://opendata@testmystorage1.blob.core.windows.net/&#34;</span>)
</code></pre></div><h2 id="spark-functions-experimental">Spark functions (experimental)</h2>
<p><code>AzureSMR</code> provides some functions that allow HDInsight Spark aessions and jobs to be managed within an R Session.</p>
<p>To create a new Spark session (via <a href="https://github.com/cloudera/hue/tree/master/apps/spark/java#welcome-to-livy-the-rest-spark-server">Livy</a>) use <code>azureSparkNewSession()</code></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#a6e22e">azureSparkNewSession</span>(context, clustername <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;spark1987&#34;</span>, 
                     hdiAdmin <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span>, 
                     hdiPassword <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span>,
                     kind <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;pyspark&#34;</span>)
</code></pre></div><p>To view the status of sessions use <code>azureSparkListSessions()</code>. Wait for status to be idle.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#a6e22e">azureSparkListSessions</span>(context, clustername <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;spark1987&#34;</span>)
</code></pre></div><p>To send a command to the Spark Session use <code>azureSparkCMD()</code>. In this case it submits a Python routine. Ensure you preserve indents for Python.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#75715e"># SAMPLE PYSPARK SCRIPT TO CALCULATE PI</span>
pythonCmd <span style="color:#f92672">&lt;-</span> <span style="color:#e6db74">&#39;
</span><span style="color:#e6db74">from pyspark import SparkContext
</span><span style="color:#e6db74">from operator import add
</span><span style="color:#e6db74">import sys
</span><span style="color:#e6db74">from random import random
</span><span style="color:#e6db74">partitions = 1
</span><span style="color:#e6db74">n = 20000000 * partitions
</span><span style="color:#e6db74">def f(_):
</span><span style="color:#e6db74">  x = random() * 2 - 1
</span><span style="color:#e6db74">  y = random() * 2 - 1
</span><span style="color:#e6db74">  return 1 if x ** 2 + y ** 2 &lt; 1 else 0
</span><span style="color:#e6db74"> 
</span><span style="color:#e6db74">count = context.parallelize(range(1, n + 1), partitions).map(f).reduce(add)
</span><span style="color:#e6db74">Pi = (4.0 * count / n)
</span><span style="color:#e6db74">print(&#34;Pi is roughly %f&#34; % Pi)&#39;</span>                   
 
<span style="color:#a6e22e">azureSparkCMD</span>(context, CMD <span style="color:#f92672">=</span> pythonCmd, sessionID <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;0&#34;</span>)

<span style="color:#75715e">## [1] &#34;Pi is roughly 3.140285&#34;</span>
</code></pre></div><p>Check Session variables are retained</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#a6e22e">azureSparkCMD</span>(context, clustername <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;spark1987&#34;</span>, CMD <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;print Pi&#34;</span>, sessionID <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;0&#34;</span>)

<span style="color:#75715e">#[1] &#34;3.1422&#34;</span>
</code></pre></div><p>You can also run SparkR sessions</p>
<p>NOT WORKING</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#a6e22e">azureSparkNewSession</span>(context, clustername <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;spark1987&#34;</span>, 
                     hdiAdmin <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;insider_danny&#34;</span>, 
                     hdiPassword <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;.Alfonstini642856&#34;</span>,
                     kind <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;sparkr&#34;</span>)


<span style="color:#a6e22e">azureSparkCMD</span>(context, clustername <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;smrhdi&#34;</span>, CMD <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;HW&lt;-&#39;hello R&#39;&#34;</span>, sessionID <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;2&#34;</span>)
<span style="color:#a6e22e">azureSparkCMD</span>(context, clustername <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;smrhdi&#34;</span>, CMD <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;cat(HW)&#34;</span>, sessionID <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;2&#34;</span>)
</code></pre></div><h1 id="spark">Spark</h1>
<h3 id="----chapter-9-----">&mdash; Chapter 9 &mdash;</h3>
<h3 id="----big-data-machine-learning-with-r-----">&mdash; Big Data machine learning with R &mdash;</h3>
<h3 id="----part-1-----">&mdash; Part 1 &mdash;</h3>
<h3 id="----glm---logistic-regression-on-spark-----">&mdash; GLM - logistic regression on Spark &mdash;</h3>
<p>Sys.getenv(&ldquo;SPARK_HOME&rdquo;)</p>
<p>Sys.setenv(SPARK_HOME = &ldquo;/usr/hdp/2.4.2.0-258/spark&rdquo;)
Sys.getenv(&ldquo;SPARK_HOME&rdquo;)
Sys.setenv(&lsquo;SPARKR_SUBMIT_ARGS'=&rsquo;&quot;&ndash;packages&rdquo; &ldquo;com.databricks:spark-csv_2.11:1.4.0&rdquo; &ldquo;sparkr-shell&rdquo;')
Sys.getenv(&ldquo;SPARKR_SUBMIT_ARGS&rdquo;)</p>
<p>library(rJava)
library(SparkR, lib.loc = c(file.path(Sys.getenv(&ldquo;SPARK_HOME&rdquo;), &ldquo;R&rdquo;, &ldquo;lib&rdquo;)))</p>
<p>sc &lt;- sparkR.init(master=&quot;yarn-client&rdquo;,
appName=&quot;SparkRStudio&rdquo;,
sparkJars = c(&quot;/usr/hdp/2.4.2.0-258/hadoop/hadoop-nfs.jar&rdquo;,
&ldquo;/usr/hdp/2.4.2.0-258/hadoop/hadoop-azure.jar&rdquo;,
&ldquo;/usr/hdp/2.4.2.0-258/hadoop/lib/azure-storage-2.2.0.jar&rdquo;),
sparkPackages=&quot;com.databricks:spark-csv_2.11:1.4.0&rdquo;)</p>
<p>sqlContext &lt;- sparkRSQL.init(sc)</p>
<p>schema &lt;- structType(structField(&ldquo;DAY_OF_WEEK&rdquo;, &ldquo;string&rdquo;),
structField(&ldquo;DEP_TIME&rdquo;, &ldquo;integer&rdquo;),
structField(&ldquo;DEP_DELAY&rdquo;, &ldquo;integer&rdquo;),
structField(&ldquo;ARR_TIME&rdquo;, &ldquo;integer&rdquo;),
structField(&ldquo;ARR_DELAY&rdquo;, &ldquo;integer&rdquo;),
structField(&ldquo;CANCELLED&rdquo;, &ldquo;integer&rdquo;),
structField(&ldquo;DIVERTED&rdquo;, &ldquo;integer&rdquo;),
structField(&ldquo;AIR_TIME&rdquo;, &ldquo;integer&rdquo;),
structField(&ldquo;DISTANCE&rdquo;, &ldquo;integer&rdquo;))</p>
<p>flights &lt;- read.df(sqlContext,
path = &ldquo;/user/swalko/data/flights_2014.csv&rdquo;,
source = &ldquo;com.databricks.spark.csv&rdquo;,
header = &ldquo;true&rdquo;,
schema = schema, nullValue = &ldquo;NA&rdquo;)</p>
<p>head(flights)
str(flights)
count(flights)</p>
<p>flights &lt;- filter(flights, flights$CANCELLED == 0)
flights &lt;- filter(flights, flights$DIVERTED == 0)</p>
<p>flights &lt;- flights[, -6:-7]
str(flights)</p>
<p>dtypes(flights)</p>
<p>registerTempTable(flights, &ldquo;flights&rdquo;)
flights &lt;- sql(sqlContext, &ldquo;SELECT *, IF(ARR_DELAY &gt; 0, 1, 0)
AS ARR_DEL from flights&rdquo;)</p>
<p>str(flights)
#We need to re-register the DataFrame as a SQL table to reflect the changes in the previous query.
registerTempTable(flights, &ldquo;flights&rdquo;)
flights &lt;- sql(sqlContext, &ldquo;SELECT *, CASE WHEN(DEP_TIME &gt;= 500 AND DEP_TIME &lt; 1200)
THEN (&lsquo;morning&rsquo;) WHEN(DEP_TIME &gt;= 1200 AND DEP_TIME &lt; 1700)
THEN (&lsquo;afternoon&rsquo;) WHEN(DEP_TIME &gt;= 1700 AND DEP_TIME &lt; 2100)
THEN (&lsquo;evening&rsquo;) ELSE(&lsquo;night&rsquo;) END AS DEP_PART from flights&rdquo;)
str(flights)
registerTempTable(flights, &ldquo;flights&rdquo;)</p>
<p>logit1 &lt;- glm(ARR_DEL ~ AIR_TIME + DISTANCE + DAY_OF_WEEK + DEP_PART + DEP_DELAY,
data = flights, family = &ldquo;binomial&rdquo;)</p>
<p>summary(logit1)</p>
<p>head(select(flights, mean(flights$AIR_TIME)))
head(select(flights, mean(flights$DISTANCE)))
head(select(flights, mean(flights$DEP_DELAY)))</p>
<p>test1 &lt;- createDataFrame(sqlContext,
data = data.frame(AIR_TIME = 111.37,
DISTANCE = 802.54,
DEP_DELAY = 10.57,
DAY_OF_WEEK = factor(rep(c(&ldquo;1&rdquo;, &ldquo;2&rdquo;,
&ldquo;3&rdquo;, &ldquo;4&rdquo;,
&ldquo;5&rdquo;, &ldquo;6&rdquo;, &ldquo;7&rdquo;), each=4)),
DEP_PART = factor(rep(c(&ldquo;morning&rdquo;, &ldquo;afternoon&rdquo;,
&ldquo;evening&rdquo;, &ldquo;night&rdquo;), times=7))))
showDF(test1)</p>
<p>predicted &lt;- predict(logit1, test1)
showDF(predicted, numRows = 28, truncate = FALSE)</p>
<p>test2 &lt;- createDataFrame(sqlContext,
data = data.frame(AIR_TIME=450,
DISTANCE=3400,
DEP_DELAY = -10,
DAY_OF_WEEK = &ldquo;1&rdquo;,
DEP_PART = &ldquo;morning&rdquo;))</p>
<p>showDF(predict(logit1, test2), truncate = FALSE)</p>
<p>flightsPred &lt;- predict(logit1, flights)
prediction &lt;- select(flightsPred, &ldquo;ARR_DEL&rdquo;, &ldquo;prediction&rdquo;)
showDF(prediction, numRows = 200)</p>
<h1 id="overall-accuracy-rate">Overall accuracy rate:</h1>
<p>prediction$success &lt;- ifelse(prediction$ARR_DEL == prediction$prediction, 1, 0)
registerTempTable(prediction, &ldquo;prediction&rdquo;)
correct &lt;- sql(sqlContext, &ldquo;SELECT count(success) FROM prediction WHERE success = 1&rdquo;)
total &lt;- count(prediction)
accuracy &lt;- collect(correct) / total
accuracy #82.7% accuracy</p>
<h1 id="accuracy-of-predicting-delayed-flights">Accuracy of predicting delayed flights:</h1>
<p>prediction &lt;- select(flightsPred, &ldquo;ARR_DEL&rdquo;, &ldquo;prediction&rdquo;)
pred_del &lt;- filter(prediction, prediction$ARR_DEL==1)
registerTempTable(pred_del, &ldquo;pred_del&rdquo;)
showDF(pred_del, numRows = 200)</p>
<p>pred_cor &lt;- sql(sqlContext, &ldquo;SELECT count(prediction) FROM prediction WHERE prediction = 1&rdquo;)
total_delayed &lt;- count(pred_del)
acc_pred &lt;- collect(pred_cor) / total_delayed
acc_pred #80% of delayed flights have been correctly identified</p>
<h1 id="using-flights_jan_2015csv-dataset-we-can-apply-the-model-on-a-new-test-data">Using flights_jan_2015.csv dataset we can apply the model on a new test data:</h1>
<p>jan15 &lt;- read.df(sqlContext,
path = &ldquo;/user/swalko/data/flights_jan_2015.csv&rdquo;,
source = &ldquo;com.databricks.spark.csv&rdquo;,
header = &ldquo;true&rdquo;,
schema = schema,
nullValue = &ldquo;NA&rdquo;)</p>
<p>str(jan15)
jan15 &lt;- filter(jan15, jan15$CANCELLED == 0)
jan15 &lt;- filter(jan15, jan15$DIVERTED == 0)
jan15 &lt;- jan15[, -6:-7]</p>
<p>registerTempTable(jan15, &ldquo;jan15&rdquo;)
jan15 &lt;- sql(sqlContext, &ldquo;SELECT *, IF(ARR_DELAY &gt; 0, 1, 0)
AS ARR_DEL from jan15&rdquo;)</p>
<p>registerTempTable(jan15, &ldquo;jan15&rdquo;)
jan15 &lt;- sql(sqlContext, &ldquo;SELECT *, CASE WHEN(DEP_TIME &gt;= 500 AND DEP_TIME &lt; 1200)
THEN (&lsquo;morning&rsquo;) WHEN(DEP_TIME &gt;= 1200 AND DEP_TIME &lt; 1700)
THEN (&lsquo;afternoon&rsquo;) WHEN(DEP_TIME &gt;= 1700 AND DEP_TIME &lt; 2100)
THEN (&lsquo;evening&rsquo;) ELSE(&lsquo;night&rsquo;) END AS DEP_PART from jan15&rdquo;)</p>
<p>jan15 &lt;- select(jan15, &ldquo;DAY_OF_WEEK&rdquo;, &ldquo;DEP_DELAY&rdquo;,
&ldquo;AIR_TIME&rdquo;, &ldquo;DISTANCE&rdquo;, &ldquo;DEP_PART&rdquo;, &ldquo;ARR_DEL&rdquo;)
str(jan15)</p>
<p>janPred &lt;- predict(logit1, jan15)
jan_eval &lt;- select(janPred, &ldquo;ARR_DEL&rdquo;, &ldquo;prediction&rdquo;)
showDF(jan_eval, numRows = 200)</p>
<h1 id="overall-accuracy-rate-1">Overall accuracy rate:</h1>
<p>jan_eval$success &lt;- ifelse(jan_eval$ARR_DEL == jan_eval$prediction, 1, 0)
registerTempTable(jan_eval, &ldquo;jan_eval&rdquo;)
correct &lt;- sql(sqlContext, &ldquo;SELECT count(success) FROM jan_eval WHERE success = 1&rdquo;)
total &lt;- count(jan_eval)
accuracy &lt;- collect(correct) / total
accuracy #80.7% accuracy</p>
<h1 id="accuracy-of-predicting-delayed-flights-1">Accuracy of predicting delayed flights:</h1>
<p>jan_eval &lt;- select(janPred, &ldquo;ARR_DEL&rdquo;, &ldquo;prediction&rdquo;)
jan_del &lt;- filter(jan_eval, jan_eval$ARR_DEL==1)
registerTempTable(jan_del, &ldquo;jan_del&rdquo;)
showDF(jan_del, numRows = 200)</p>
<p>jan_cor &lt;- sql(sqlContext, &ldquo;SELECT count(prediction) FROM jan_del WHERE prediction = 1&rdquo;)
total_delayed &lt;- count(jan_del)
acc_pred &lt;- collect(jan_cor) / total_delayed
acc_pred #67.3% of delayed flights have been correctly identified</p>
<h3 id="----end-of-part-1-----">&mdash; End of Part 1 &mdash;</h3>
<h3 id="----part-2-----">&mdash; Part 2 &mdash;</h3>
<h3 id="----h2oai-on-r---naive-bayes-----">&mdash; H2O.ai on R - Naive Bayes &mdash;</h3>
<p>library(h2o)
h2o &lt;- h2o.init(ip = &ldquo;10.2.0.10&rdquo;, port = 54321, startH2O = F)
h2o.clusterInfo()</p>
<p>path1 &lt;- &ldquo;/home/swalko/data/flights_2014.csv&rdquo;
flights14 &lt;- h2o.uploadFile(path = path1,
destination_frame = &ldquo;flights14&rdquo;,
parse = TRUE, header = TRUE,
sep = &ldquo;,&quot;)</p>
<p>h2o.ls()</p>
<p>summary(flights14)
str(flights14)</p>
<p>flights14 &lt;- flights14[flights14$CANCELLED==0 &amp; flights14$DIVERTED==0, ]
flights14 &lt;- flights14[, -6:-7]</p>
<p>h2o.nacnt(flights14) #no missing values</p>
<p>flights14$DAY_OF_WEEK &lt;- as.factor(flights14$DAY_OF_WEEK)</p>
<p>avg_del &lt;- function(x) { sum(x[,3])/nrow(x) }
avg.del &lt;- h2o.ddply(flights14, &ldquo;DAY_OF_WEEK&rdquo;, FUN = avg_del)
as.data.frame(avg.del)</p>
<p>flights14$DEP_PART &lt;- h2o.cut(flights14$DEP_TIME,
c(1, 459, 1159, 1659, 2059, 2400),
labels = c(&ldquo;night&rdquo;, &ldquo;morning&rdquo;,
&ldquo;afternoon&rdquo;, &ldquo;evening&rdquo;,
&ldquo;night&rdquo;))
h2o.table(flights14$DEP_PART)</p>
<p>flights14$DEP_TIME &lt;- flights14$ARR_TIME &lt;- NULL</p>
<p>flights14$ARR_DEL &lt;- as.factor(h2o.ifelse(flights14$ARR_DELAY &gt; 0, 1, 0))</p>
<p>flights14$ARR_DELAY &lt;- NULL
h2o.table(flights14$ARR_DEL)
prop.table(h2o.table(flights14$ARR_DEL)) #42% of delayed flights overall</p>
<p>summary(flights14$DEP_DELAY)
flights14$DEP_DELAY &lt;- h2o.cut(flights14$DEP_DELAY,
c(-112, -15, -1, 1, 16, 2402),
labels = c(&ldquo;very early&rdquo;,
&ldquo;somewhat early&rdquo;,
&ldquo;on time&rdquo;,
&ldquo;somewhat delayed&rdquo;,
&ldquo;very delayed&rdquo;))
h2o.table(flights14$DEP_DELAY)</p>
<p>h2o.quantile(flights14$DISTANCE, prob = seq(0, 1, length = 4))
#h2o.hist(flights14$DISTANCE)
summary(flights14$DISTANCE)
flights14$DISTANCE &lt;- h2o.cut(flights14$DISTANCE,
c(31, 1000, 2000, 4983),
labels = c(&ldquo;short&rdquo;, &ldquo;medium&rdquo;, &ldquo;long&rdquo;))
h2o.table(flights14$DISTANCE)</p>
<p>h2o.quantile(flights14$AIR_TIME, prob = seq(0, 1, length = 4))
#h2o.hist(flights14$AIR_TIME)
summary(flights14$AIR_TIME)
flights14$AIR_TIME &lt;- h2o.cut(flights14$AIR_TIME,
c(7, 150, 300, 706),
labels = c(&ldquo;short&rdquo;, &ldquo;medium&rdquo;, &ldquo;long&rdquo;))
h2o.table(flights14$AIR_TIME)
str(flights14)</p>
<p>model1 &lt;- h2o.naiveBayes(x = 1:5, y = 6, training_frame = flights14, laplace = 1)
model1</p>
<p>str(model1)
h2o.auc(model1)
h2o.performance(model1)</p>
<p>path2 &lt;- &ldquo;/home/swalko/data/flights_jan_2015.csv&rdquo;
flightsJan15 &lt;- h2o.uploadFile(path = path2,
destination_frame = &ldquo;flightsJan15&rdquo;,
parse = TRUE, header = TRUE,
sep = &ldquo;,&quot;)</p>
<p>flightsJan15 &lt;- flightsJan15[flightsJan15$CANCELLED==0 &amp; flightsJan15$DIVERTED==0, ]
flightsJan15 &lt;- flightsJan15[, -6:-7]</p>
<p>h2o.nacnt(flightsJan15)</p>
<p>flightsJan15$DAY_OF_WEEK &lt;- as.factor(flightsJan15$DAY_OF_WEEK)
flightsJan15$DEP_PART &lt;- h2o.cut(flightsJan15$DEP_TIME,
c(1, 459, 1159, 1659, 2059, 2400),
labels = c(&ldquo;night&rdquo;, &ldquo;morning&rdquo;,
&ldquo;afternoon&rdquo;, &ldquo;evening&rdquo;,
&ldquo;night&rdquo;))</p>
<p>flightsJan15$DEP_TIME &lt;- flightsJan15$ARR_TIME &lt;- NULL
flightsJan15$ARR_DEL &lt;- as.factor(h2o.ifelse(flightsJan15$ARR_DELAY &gt; 0, 1, 0))
flightsJan15$ARR_DELAY &lt;- NULL
h2o.table(flightsJan15$ARR_DEL)
prop.table(h2o.table(flightsJan15$ARR_DEL)) #40% of delayed flights</p>
<p>summary(flightsJan15$DEP_DELAY)
flightsJan15$DEP_DELAY &lt;- h2o.cut(flightsJan15$DEP_DELAY,
c(-48, -15, -1, 1, 16, 1988),
labels = c(&ldquo;very early&rdquo;,
&ldquo;somewhat early&rdquo;,
&ldquo;on time&rdquo;,
&ldquo;somewhat delayed&rdquo;,
&ldquo;very delayed&rdquo;))
h2o.table(flightsJan15$DEP_DELAY)</p>
<p>h2o.quantile(flightsJan15$DISTANCE, prob = seq(0, 1, length = 4))
#h2o.hist(flightsJan15$DISTANCE)
summary(flightsJan15$DISTANCE)
flightsJan15$DISTANCE &lt;- h2o.cut(flightsJan15$DISTANCE,
c(31, 1000, 2000, 4983),
labels = c(&ldquo;short&rdquo;,
&ldquo;medium&rdquo;,
&ldquo;long&rdquo;))
h2o.table(flightsJan15$DISTANCE)</p>
<p>h2o.quantile(flightsJan15$AIR_TIME, prob = seq(0, 1, length = 4))
#h2o.hist(flightsJan15$AIR_TIME)
summary(flightsJan15$AIR_TIME)
flightsJan15$AIR_TIME &lt;- h2o.cut(flightsJan15$AIR_TIME,
c(8, 150, 300, 676),
labels = c(&ldquo;short&rdquo;,
&ldquo;medium&rdquo;,
&ldquo;long&rdquo;))
h2o.table(flightsJan15$AIR_TIME)</p>
<p>str(flightsJan15)</p>
<p>fit1 &lt;- h2o.predict(object = model1, newdata = flightsJan15)
fit1</p>
<p>h2o.performance(model1, newdata = flightsJan15)</p>
<h3 id="----end-of-part-2-----">&mdash; End of Part 2 &mdash;</h3>
<h3 id="----part-3-----">&mdash; Part 3 &mdash;</h3>
<h3 id="----neural-networks-and-deep-learning-on-h2oai-----">&mdash; Neural Networks and Deep Learning on H2O.ai &mdash;</h3>
<p>rm(list=ls())
path1 &lt;- &ldquo;/home/swalko/data/flights_2014.csv&rdquo;
flights14 &lt;- h2o.uploadFile(path = path1,
destination_frame = &ldquo;flights14&rdquo;,
parse = TRUE, header = TRUE,
sep = &ldquo;,&quot;)
h2o.ls()</p>
<p>#summary(flights14)
#str(flights14)</p>
<p>flights14 &lt;- flights14[flights14$CANCELLED==0 &amp; flights14$DIVERTED==0, ]
flights14 &lt;- flights14[, -6:-7]</p>
<p>flights14$DAY_OF_WEEK &lt;- as.factor(flights14$DAY_OF_WEEK)
flights14$ARR_DEL &lt;- as.factor(h2o.ifelse(flights14$ARR_DELAY &gt; 0, 1, 0))
flights14$ARR_DELAY &lt;- flights14$ARR_TIME &lt;- NULL
str(flights14)</p>
<p>path2 &lt;- &ldquo;/home/swalko/data/flights_jan_2015.csv&rdquo;
flightsJan15 &lt;- h2o.uploadFile(path = path2,
destination_frame = &ldquo;flightsJan15&rdquo;,
parse = TRUE, header = TRUE,
sep = &ldquo;,&quot;)</p>
<p>flightsJan15 &lt;- flightsJan15[flightsJan15$CANCELLED==0 &amp; flightsJan15$DIVERTED==0, ]
flightsJan15 &lt;- flightsJan15[, -6:-7]</p>
<p>flightsJan15$DAY_OF_WEEK &lt;- as.factor(flightsJan15$DAY_OF_WEEK)
flightsJan15$ARR_DEL &lt;- as.factor(h2o.ifelse(flightsJan15$ARR_DELAY &gt; 0, 1, 0))
flightsJan15$ARR_DELAY &lt;- flightsJan15$ARR_TIME &lt;- NULL
str(flightsJan15)</p>
<p>model2 &lt;- h2o.deeplearning(x = 1:5, y = 6, training_frame = flights14,
validation_frame = flightsJan15,
hidden = c(10, 5, 3),
epochs = 5)</p>
<p>summary(model2)</p>
<p>model3 &lt;- h2o.deeplearning(x = 1:5, y = 6, training_frame = flights14,
validation_frame = flightsJan15,
epochs = 2)</p>
<p>summary(model3)</p>
<p>h2o.shutdown()</p>
<h3 id="----end-of-part-3-----">&mdash; End of Part 3 &mdash;</h3>
<h3 id="----the-end-of-chapter-9-----">&mdash; The end of Chapter 9 &mdash;</h3>
					</div>
					<div class="post-comments">
						
					</div>
				</div>
			</div>
      <div class="col-md-4">
        <aside class="sidebar">
  
  <div class="widget widget-latest-post">
    <h4 class="widget-title">Latest Posts</h4>
    
    <div class="media">
      <a class="pull-left" href="../../blog/blog-post-1/">
        <img class="media-object" src="../../images/blog/blog-post-1.jpg" alt="How To Wear Bright Shoes">
      </a>
      <div class="media-body">
        <h4 class="media-heading"><a href="../../blog/blog-post-1/">How To Wear Bright Shoes</a></h4>
        <p>Lorem ipsum dolor sit amet, consectetur </p>
      </div>
    </div>
    
    <div class="media">
      <a class="pull-left" href="../../blog/blog-post-2/">
        <img class="media-object" src="../../images/blog/blog-post-2.jpg" alt="How To Wear Bright Shoes">
      </a>
      <div class="media-body">
        <h4 class="media-heading"><a href="../../blog/blog-post-2/">How To Wear Bright Shoes</a></h4>
        <p>Lorem ipsum dolor sit amet, consectetur </p>
      </div>
    </div>
    
    <div class="media">
      <a class="pull-left" href="../../blog/blog-post-3/">
        <img class="media-object" src="../../images/blog/blog-post-3.jpg" alt="How To Wear Bright Shoes">
      </a>
      <div class="media-body">
        <h4 class="media-heading"><a href="../../blog/blog-post-3/">How To Wear Bright Shoes</a></h4>
        <p>Lorem ipsum dolor sit amet, consectetur </p>
      </div>
    </div>
    
    <div class="media">
      <a class="pull-left" href="../../blog/blog-post-4/">
        <img class="media-object" src="../../images/blog/blog-post-4.jpg" alt="How To Wear Bright Shoes">
      </a>
      <div class="media-body">
        <h4 class="media-heading"><a href="../../blog/blog-post-4/">How To Wear Bright Shoes</a></h4>
        <p>Lorem ipsum dolor sit amet, consectetur </p>
      </div>
    </div>
    
  </div>
  

  
  <div class="widget widget-category">
    <h4 class="widget-title">Categories</h4>
    <ul class="widget-category-list">
      <li><a href="../../categories/artificial-intelligence">Artificial intelligence</a></li>
      <li><a href="../../categories/cloud">Cloud</a></li>
      <li><a href="../../categories/company-news">Company news</a></li>
      <li><a href="../../categories/legacy-support">Legacy support</a></li>
      <li><a href="../../categories/python">Python</a></li>
      <li><a href="../../categories/r">R</a></li>
    </ul>
  </div> 

  
  <div class="widget widget-tag">
    <h4 class="widget-title">Tags</h4>
    <ul class="widget-tag-list">
      <li><a href="../../tags/advice">Advice</a></li>
      <li><a href="../../tags/ai">Ai</a></li>
      <li><a href="../../tags/android">Android</a></li>
      <li><a href="../../tags/api">Api</a></li>
      <li><a href="../../tags/azure">Azure</a></li>
      <li><a href="../../tags/bigdata">Bigdata</a></li>
      <li><a href="../../tags/django">Django</a></li>
      <li><a href="../../tags/docker">Docker</a></li>
      <li><a href="../../tags/engineering">Engineering</a></li>
      <li><a href="../../tags/flask">Flask</a></li>
      <li><a href="../../tags/gcp">Gcp</a></li>
      <li><a href="../../tags/linux">Linux</a></li>
      <li><a href="../../tags/mechine">Mechine</a></li>
      <li><a href="../../tags/ml">Ml</a></li>
      <li><a href="../../tags/ops">Ops</a></li>
      <li><a href="../../tags/r-package">R package</a></li>
      <li><a href="../../tags/retro">Retro</a></li>
      <li><a href="../../tags/rstudio">Rstudio</a></li>
      <li><a href="../../tags/set-up">Set up</a></li>
      <li><a href="../../tags/shiny">Shiny</a></li>
      <li><a href="../../tags/technology">Technology</a></li>
      <li><a href="../../tags/viz">Viz</a></li>
      <li><a href="../../tags/webdev">Webdev</a></li>
    </ul>
  </div> 
</aside>
      </div>
		</div>
	</div>
</section>

<footer class="footer">
	<div class="container">
		<div class="row">
			<div class="col-md-12">
				<div class="footer-manu">
					<ul>
            
            <li><a href="about">About</a></li>
            
            <li><a href="project">Project</a></li>
            
            <li><a href="service">Service</a></li>
            
            <li><a href="pricing">Pricing</a></li>
            
            <li><a href="faq">FAQ</a></li>
            
            <li><a href="contact">Contact</a></li>
            
					</ul>
				</div>
				<p class="copyright">Copyright  2019 <a href="https://themefisher.com">Themefisher</a> All Rights Reserved</p>
			</div>
		</div>
	</div>
</footer>



<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCcABaamniA6OL5YvYSpB3pFMNrXwXnLwU&amp;libraries=places"></script>




<script src="../../plugins/jQuery/jquery.min.js"></script>

<script src="../../plugins/bootstrap/bootstrap.min.js"></script>

<script src="../../plugins/slick/slick.min.js"></script>

<script src="../../plugins/magnific-popup/jquery.magnific-popup.min.js"></script>

<script src="../../plugins/shuffle/shuffle.min.js"></script>

<script src="../../plugins/google-map/gmap.js"></script>

<script src="../../plugins/smartslider3/js/GsapMorphSVGPlugin.min.js"></script>

<script src="../../plugins/smartslider3/js/n2-j.min.js"></script>

<script src="../../plugins/smartslider3/js/nextend-frontend.min.js"></script>

<script src="../../plugins/smartslider3/js/nextend-gsap.min.js"></script>

<script src="../../plugins/smartslider3/js/nextend-webfontloader.min.js"></script>

<script src="../../plugins/smartslider3/js/smartslider-block-type-frontend.min.js"></script>

<script src="../../plugins/smartslider3/js/smartslider-frontend.min.js"></script>

<script src="../../plugins/smartslider3/js/smartslider-simple-type-frontend.min"></script>




<script src="../../js/script.min.js"></script>


</body>

</html>